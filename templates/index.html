<!DOCTYPE html>
<html>
<head>
    <title>Zoza Casino</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        body {
        font-family: Arial, sans-serif;
        background-color: #131320;
        color: white;
        }

        .title {
        margin-top: 5px;
        }
        /* Стили для слота */
        .slot-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .slot-row {
            display: flex;
        }

        .slot-symbol {
            width: 170px;
            height: 170px;
            margin: 2px;
        }

        #slot-board {
        background: #131320;
        border: 2px solid #008979;
        padding: 2px;
        box-sizing: border-box;
        }

        #spin-button {
        margin-top: 20px;
        font-size: 28px;
        border-radius: 8px;
        border: 2px solid #008979;
        background-color: #131320;
        color: white;
        padding: 8px;
        box-sizing: border-box; /* чтобы padding учитывался внутри ширины */
        cursor: pointer;
        }

        #winnings {
        font-size: 28px;
        border-radius: 8px;
        background-color: #131320;
        border: 2px solid #008979;
        padding: 8px;
        box-sizing: border-box; /* чтобы padding учитывался внутри ширины */
        }

        #bonus-message {
        margin-top: 10px;
        font-size: 28px;
        border-radius: 8px;
        background-color: #131320;
        padding: 8px;
        box-sizing: border-box; /* чтобы padding учитывался внутри ширины */
        }

        #balance { /* добавили стиль для balance */
            margin-top: 10px;
            border: 2px solid #008979;
            border-radius: 8px;
            background-color: #131320;
            padding: 8px;
            font-size: 28px;
            box-sizing: border-box; /* чтобы padding учитывался внутри ширины */
        }

        .controls {
            display: flex;
            justify-content: center; /* Равномерное распределение элементов */
            align-items: center; /* Выравнивание по вертикали */
            margin-top: 20px;
            padding: 10px;
            font-size: 28px;
        }

        .controls button, .controls input, .controls span {
            margin: 0 30px; /* Отступы между элементами */
        }

        #bet-button { 
            border: 2px solid #008979;
            border-radius: 8px;
            background-color: #131320;
            padding: 8px;
            font-size: 28px;
            box-sizing: border-box; /* чтобы padding учитывался внутри ширины */
            }

            .lines {
            height: 66px;
            border: 2px solid #008979;
            border-radius: 8px;
            background-color: #131320;
            padding: 8px;
            font-size: 28px;
            box-sizing: border-box; /* чтобы padding учитывался внутри ширины */

            }

            .lines2 { 
            border-radius: 8px;
            background-color: #131320;
            padding: 8px;
            font-size: 28px;
            box-sizing: border-box; /* чтобы padding учитывался внутри ширины */
            }

            #bet-input {
            font-size: 28px;
            text-align: left;
            height: 30px;
            width: 150px;
            border: 0.01px solid #131320;
            background-color: #131320;
            font-family: Arial, sans-serif;
            color: white;
            margin-right: -8px;
            text-align: center;
            margin-left: 11px;
            outline: none; /*  Убираем стандартный outline чтоб после нажатия рамка была того же цвета */
      }

            #winnings {
            font-size: 28px;
            text-align: left;
            height: 46px;
            width: 100px;
            border: 1px solid #131320;
            background-color: #131320;
            font-family: Arial, sans-serif;
            color: white;
            padding: 1px;
            box-sizing: border-box;
            text-align: center;
            margin-left: 11px;
            margin-right: 7px;
         }

           #balance {
            font-size: 28px;
            text-align: left;
            height: 46px;
            width: 100px;
            border: 1px solid #131320;
            background-color: #131320;
            font-family: Arial, sans-serif;
            color: white;
            padding: 1px;
            box-sizing: border-box;
            text-align: center;
            margin-left: 11px;
            margin-right: 7px;
      }
    </style>
</head>
<body>
    <div class="slot-container">
        <h1>Собаки</h1>
        <div id="slot-board">
            <!-- Здесь будет отображаться игровое поле -->
        </div>
        <button id="spin-button">Spin</button></div>
        <div class="controls">
        <span class="lines2">
        <span class="lines">Баланс:<span id="balance">100000</span></span>
        <span class="lines" id="bet-button">Ставка:<input type="number" id="bet-input" value="10"></span>
        <span class="lines">Выигрыш:<span id="winnings">0</span></span></div>
        <p id="bonus-message"></p>
    </div>

    <script>
        const spinButton = document.getElementById('spin-button');
        const slotBoard = document.getElementById('slot-board');
        const winningsDisplay = document.getElementById('winnings');
        const bonusMessage = document.getElementById('bonus-message');
        const balanceDisplay = document.getElementById('balance');
        const betInput = document.getElementById('bet-input');
        let currentBet = 10; // Начальная ставка

        betInput.addEventListener('change', () => {
            const newBet = parseInt(betInput.value);
            if (!isNaN(newBet) && newBet > 0) {
                currentBet = newBet;
            } else {
                alert('Пожалуйста, введите корректную ставку.');
                betInput.value = currentBet;
            }
        });
spinButton.addEventListener('click', async () => {
    try {
        const response = await fetch('/spin', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({bet: currentBet}) // Отправляем текущую ставку
        });
    if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
    }
    const data = await response.json();
    if (data.error) {
        alert(data.error);
        balanceDisplay.textContent = data.balance; // Обновляем баланс даже при ошибке
    } else {
        balanceDisplay.textContent = data.balance;
        slotBoard.innerHTML = '';
        data.board.forEach(row => {
            const rowElement = document.createElement('div');
            rowElement.className = 'slot-row';
            row.forEach(image => {
                const imgElement = document.createElement('img');
                imgElement.src = image;
                imgElement.className = 'slot-symbol';
                rowElement.appendChild(imgElement);
            });
            slotBoard.appendChild(rowElement);
        });

        winningsDisplay.textContent = data.total_winnings;
        bonusMessage.textContent = data.bonus_message || '';
    }
    } catch (error) {
        console.error('Error:', error);
        alert('Произошла ошибка при выполнении спина.');
    }
});
    </script>
</body>
</html>